# Patch to add test environment variables to frontend
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend
spec:
  template:
    spec:
      containers:
      - name: frontend
        env:
        # Backend API URL for server-side Next.js API routes
        - name: BACKEND_URL
          value: "http://backend-service.ambient-code.svc.cluster.local:8080/api"
        # E2E testing: provide token for both server-side and client-side
        - name: OC_TOKEN
          valueFrom:
            secretKeyRef:
              name: test-user-token
              key: token
        # NEXT_PUBLIC_ vars are exposed to client-side code
        - name: NEXT_PUBLIC_E2E_TOKEN
          valueFrom:
            secretKeyRef:
              name: test-user-token
              key: token
        - name: OC_USER
          value: "system:serviceaccount:ambient-code:test-user"
        - name: OC_EMAIL
          value: "test-user@vteam.local"

